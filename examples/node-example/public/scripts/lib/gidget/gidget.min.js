/*! gidget-builder 2015-08-01 */
Hilary.scope("gidget").register({name:"IGidget",dependencies:["Blueprint"],factory:function(a){"use strict";return new a({__blueprintId:"IGidget",GidgetModule:"function",GidgetRoute:{type:"function",args:["route"]},Bootstrapper:{type:"function",args:["scope","bootstrapper"]}})}}),Hilary.scope("gidget").register({name:"IGidgetApp",dependencies:["Blueprint"],factory:function(a){"use strict";return new a({__blueprintId:"IGidgetApp",start:"function",routeEngine:"object",pipelines:"object",registerModule:{type:"function",args:["gidgetModule"]},registerModules:{type:"function",args:["gidgetModules"]}})}}),Hilary.scope("gidget").register({name:"IGidgetModule",dependencies:["Blueprint"],factory:function(a){"use strict";return new a({__blueprintId:"IGidgetModule",get:"object",post:"object",put:"object",del:"object",any:"object"})}}),Hilary.scope("gidget").register({name:"IGidgetRoute",dependencies:["Blueprint"],factory:function(a){"use strict";return new a({__blueprintId:"IGidgetRoute",routeHandler:"function"})}}),Hilary.scope("gidget").register({name:"IRouteEngine",dependencies:["Blueprint"],factory:function(a){"use strict";return new a({__blueprintId:"IRouteEngine",get:{type:"function",args:["path","callback"]},post:{type:"function",args:["path","callback"]},put:{type:"function",args:["path","callback"]},del:{type:"function",args:["path","callback"]},navigate:{type:"function",args:["path","data","pushStateToHistory"]},start:"function",resolveRoute:{type:"function",args:["path"]},resolveAndExecuteRoute:{type:"function",args:["path"]},dispose:"function",pipeline:"object"})}}),Hilary.scope("gidget").register({name:"locale",factory:{errors:{requiresArguments:"The {func} function requires arguments {args}",pipelineRequiresCallback:"A callback function is required to register a pipeline event",parseUriRequiresUriString:"A uriString is required to parse a URI",status404:"Not Found!",interfaces:{requiresImplementation:"A valid implementation is required to create a new instance of an interface",requiresProperty:"The implementation is missing a required property: ",requiresArguments:"The implementation of this function requires the arguments: ",notAnIRouteEngine:"The router instance that was passed into the RouteEngine constructor does not implement IRouteEngine",notAnIGidgetApp:"The gidgetApp instance that were passed into the GidgetApp constructor does not implement IGidgetApp",notAnIGidgetModule:"The module that you are trying to register does not implement IGidgetModule",missingOptions:"To create a Gidget instance, you must provide the minimum required options"}}}}),Hilary.scope("gidget").register({name:"argumentValidator",dependencies:["locale","exceptions"],factory:function(a,b){"use strict";return{validate:function(a,c){var d,e=a.syncSignatureMatches(c);if(e.result)return!0;for(d=0;d<e.errors.length;d+=1)b.throwArgumentException(e.errors[d]);return e}}}}),Hilary.scope("gidget").register({name:"ExceptionHandler",dependencies:[],factory:function(a){"use strict";var b,c={makeException:void 0,argumentException:void 0,throwArgumentException:void 0,notImplementedException:void 0,throwNotImplementedException:void 0,fetchException:void 0,throwFetchException:void 0,throwException:void 0,"throw":void 0};return a="function"==typeof a?a:function(a){throw console.error(a),a},b=function(a,b,c){var d,e;return"object"==typeof a&&"string"==typeof a.message?(d=a.message,e=a):(d="string"==typeof b?b:a,e=new Error(d)),e.message=d,a!==d&&(e.name=a),c&&(e.data=c),e},c.makeException=b,c.argumentException=function(a,c,d){var e="undefined"==typeof c?a:a+" (argument: "+c+")";return b("ArgumentException",e,d)},c.throwArgumentException=function(a,b,d){c["throw"](c.argumentException(a,b,d))},c.notImplementedException=function(a,c){return b("NotImplementedException",a,c)},c.throwNotImplementedException=function(a,b){c["throw"](c.notImplementedException(a,b))},c.fetchException=function(a){return a=a||{},a.status=a.status||"unknown",b("FetchException","Server Request Failed with status: "+a.status,a)},c.throwFetchException=function(a){throw c["throw"](c.fetchException(a)),new Error("Server Request Failed with status: "+a.status)},c.throwException=function(a){c["throw"](a)},c["throw"]=function(c){a("string"==typeof c?b(c):c)},c}}),Hilary.scope("gidget").register({name:"GidgetApp",dependencies:["IGidgetModule","argumentValidator","is"],factory:function(a,b,c){"use strict";var d=function(d){var e={start:void 0,pipelines:{},registerModule:void 0,registerModules:void 0};return e.start=d.start,e.routeEngine=d,e.pipelines.beforeRouteResolution=d.beforeRouteResolution,e.pipelines.afterRouteResolution=d.afterRouteResolution,e.pipelines.before=d.before,e.pipelines.after=d.after,e.pipelines.onError=d.onError,e.registerModule=function(c){if(b.validate(a,c)){var e,f,g,h,i=c.get,j=c.put,k=c.posts,l=c.dels;for(e in i)i.hasOwnProperty(e)&&d.get(e,i[e]);for(f in j)j.hasOwnProperty(f)&&d.put(f,j[f]);for(g in k)k.hasOwnProperty(g)&&d.post(g,k[g]);for(h in l)l.hasOwnProperty(h)&&d.del(h,l[h])}},e.registerModules=function(a){if(c.array(a)){var b;for(b=0;b<a.length;b+=1)e.registerModule(a[b])}},e};return d}}),Hilary.scope("gidget").register({name:"GidgetModule",dependencies:[],factory:function(){"use strict";return function(){var a={};return a.get={},a.post={},a.put={},a.del={},a.any={},a}}}),Hilary.scope("gidget").register({name:"GidgetPipeline",dependencies:["is","locale"],factory:function(a,b){"use strict";var c=function(){var c,d,e,f;return c={before:{routeResolution:void 0,routeExecution:void 0},after:{routeResolution:void 0,routeExecution:void 0},on:{error:void 0},trigger:{before:{routeResolution:void 0,routeExecution:void 0},after:{routeResolution:void 0,routeExecution:void 0},on:{error:void 0}}},d={beforeRouteResolution:[],afterRouteResolution:[],before:[],after:[],error:[]},f=function(d){return a.not["function"](d)?(c.trigger.on.error({status:500,message:b.errors.pipelineRequiresCallback}),!1):!0},e=function(b,c){var d,e=[],f=function(d){return function(e,g){b.length===d?a["function"](c)&&c(e,g):b[d](e,g,f(d+1))}};for(d=0;d<b.length;d+=1)e.push(f(d));return e},c.trigger.before.routeExecution=function(a,b,c){var f=e(d.before,c);f.length?f[0](a,b):c(a,b)},c.trigger.after.routeExecution=function(a,b){var c=e(d.after);c.length&&c[0](a,b)},c.trigger.on.error=function(a){var b;for(b=0;b<d.error.length;b+=1)d.error[b](a)},c.trigger.before.routeResolution=function(a,b){var c=e(d.beforeRouteResolution,b);c.length?c[0](null,a):b(null,a)},c.trigger.after.routeResolution=function(a,b){var c=e(d.afterRouteResolution,b);c.length?c[0](null,a):b(null,a)},c.before.routeResolution=function(a){f(a)&&(a.length<2?d.beforeRouteResolution.push(function(b,c){a(b),c(null,b)}):d.beforeRouteResolution.push(a))},c.after.routeResolution=function(a){f(a)&&(a.length<3?d.afterRouteResolution.push(function(b,c,d){a(b,c),d(null,c)}):d.afterRouteResolution.push(a))},c.before.routeExecution=function(a){f(a)&&(a.length<3?d.before.push(function(b,c,d){a(b,c),d(null,c)}):d.before.push(a))},c.after.routeExecution=function(a){f(a)&&d.after.push(a)},c.on.error=function(a){f(a)&&d.error.push(a)},c};return c}}),Hilary.scope("gidget").register({name:"GidgetResponse",dependencies:["is"],factory:function(a){"use strict";return function(b){var c,d=this;c=a.string(b)?{}:b||{},d.uri=b.uri,d.route=b.route,d.params=b.params}}}),Hilary.scope("gidget").register({name:"GidgetRoute",dependencies:["IGidgetRoute","argumentValidator"],factory:function(a,b){"use strict";return function(c){if(b.validate(a,c)){var d=c.routeHandler;return"function"==typeof c.before&&(d.before=c.before),"function"==typeof c.after&&(d.after=c.after),d}}}}),Hilary.scope("gidget").register({name:"BaseRouteEngine",dependencies:["Route","GidgetResponse","GidgetPipeline","is","uriHelper","locale","exceptions"],factory:function(a,b,c,d,e,f,g){"use strict";var h=function(h){var i,j,k,l,m,n,o,p=new c,q=[];return h=h||{},i={get:h.get,post:h.post,put:h.put,del:h.del,navigate:h.navigate,parseRoute:void 0,resolveRoute:void 0,resolveAndExecuteRoute:void 0,start:h.start,pipeline:p},j={escapeRegExp:/[-[\]{}()+?.,\\^$|#\s]/g,namedParam:/:(\w+)/g,splatParam:/\*(\w+)/g,firstParam:/(:\w+)|(\*\w+)/,allParams:/(:|\*)\w+/g,extractHash:/^[^#]*(#.*)$/},k=function(a){if(d["function"](a)&&a.length<3){var b=function(b,c,d){a(b,c),d(b,c)};return b.before=k(a.before),b.after=k(a.after),b}return a},l=function(a){return function(b,c){var e,f,g,h,i;e=function(){d["function"](a.before)?a.before(null,c,f):f(null,c)},f=function(a,b){p.trigger.before.routeExecution(a,b,g)},g=function(b,c){a(b,c,h)},h=function(b,c){d["function"](a.after)?a.after(b,c,i):i(b,c)},i=function(a,b){p.trigger.after.routeExecution(a,b)},e()}},m=function(a,b,c){(d.not.defined(b)||d.not["function"](c))&&g.throwArgumentException(f.errors.requiresArguments.replace("{func}","addRoute").replace("{args}","(verb, path, callback)")),q.push({route:n(a,b),callback:l(k(c))})},n=function(b,c,d){var e,f,g,h;return h=String(c),f=h.match(j.allParams),g=null!==f?function(){var a,b,c;for(c=[],a=0,b=f.length;b>a;a+=1)e=f[a],c.push(e.substr(1));return c}():[],h=h.replace(j.escapeRegExp,"\\$&"),h=h.replace(j.namedParam,"([^/]+)"),h=h.replace(j.splatParam,"(.+?)"),new a({expressionString:h,paramNames:g,verb:b,source:c},d)},o=function(a,b){var c,e,f={};if(c=a.match(b.expression),d.not.array(c)||1===c.length)return f.splat=[],f;for(c.shift(),f.splat=c,e=0;e<b.paramNames.length;e+=1)f[b.paramNames[e].replace(/:/g,"")]=f.splat[e];return f},i.get=i.get||function(a,b){return m("get",a,b)},i.post=i.post||function(a,b){return m("post",a,b)},i.put=i.put||function(a,b){return m("put",a,b)},i.del=i.del||function(a,b){return m("del",a,b)},i.resolveRoute=function(a){var c,d,f,g=e.parseUri(a);for(c=0;c<q.length;c+=1)if(q[c].route.expression.test(g.path)){d=q[c];break}return d?(f=o(g.path,d.route),new b({route:d,params:f,uri:g})):!1},i.resolveAndExecuteRoute=function(a){var b,c,g,h,j=e.parseUri(a);b=function(){p.trigger.before.routeResolution(j,c)},c=function(a,b){return a?void p.trigger.on.error(a):(h=i.resolveRoute(b),void(h===!1?(a={status:404,message:f.errors.status404,uri:b},p.trigger.on.error(a)):d["function"](h.route.callback)&&g(h)))},g=function(a){p.trigger.after.routeResolution(a,a.route.callback)},b()},i};return h}}),function(a,b){"use strict";a.scope("gidget").register({name:"DefaultRouteEngine",dependencies:["BaseRouteEngine","is","uriHelper"],factory:function(a,c,d){var e,f,g,h,i,j;return e=function(){g(),f()},f=function(){j.navigate(location.href)},h=function(a){c.string(a.target.localName)&&"a"===a.target.localName&&(a.preventDefault(),j.navigate(a.target.href))},i=function(a){c.string(a.state)?(a.preventDefault(),j.navigate(a.state,null,!1)):c.object(a.state)&&c.defined(a.state.path)&&(a.preventDefault(),j.navigate(a.state.path))},g=function(){document.addEventListener("click",h,!1),window.addEventListener("popstate",i,!1)},j=new a({start:e}),j.navigate=function(a,e,f){var g=e||{},h=d.parseUri(a);return c.not.defined(f)&&(f=!0),h.host&&h.host!==document.location.host?void(window.location=a):(g.uri=h,g.title=window.title,f&&b.pushState(g.uri,g.title,g.relativePath),void j.resolveAndExecuteRoute(g.uri))},j.dispose=function(){document.removeEventListener("click",h,!1),window.removeEventListener("popstate",i,!1)},j}})}(Hilary,window.history),Hilary.scope("gidget").register({name:"DefaultGidgetBootstrapper",dependencies:["is"],factory:function(a){"use strict";var b=function(b,c){var d,e,f,g,h,i;b=b||new Hilary,c=c||{},c.options=c.options||{},c.hilary=c.hilary||{},i=function(a){console.log(a)},d=function(){a["function"](c.start)?c.start(null,e):e(null,new Gidget(c.options))},e=function(b,d){b&&i(b),a["function"](c.composeLifecycle)&&4===c.composeLifecycle.length?c.composeLifecycle(b,d,d.pipelines,f):a["function"](c.composeLifecycle)?(c.composeLifecycle(b,d,d.pipelines),f(b,d)):f(b,d)},f=function(e,f){e&&i(e),b.register({name:"gidgetApp",factory:function(){return f}}),b.register({name:"gidgetRouter",factory:function(){return f.routeEngine}}),b.register({name:"application",factory:function(){return{restart:function(){d()}}}}),a["function"](c.composeModules)&&3===c.composeModules.length?c.composeModules(e,f,g):a["function"](c.composeModules)?(c.composeModules(e,f),g(e,f)):g(e,f)},g=function(b,d){b&&i(b),a["function"](c.composeRoutes)&&3===c.composeRoutes.length?c.composeRoutes(b,d,h):a["function"](c.composeRoutes)?(c.composeRoutes(b,d),h(b,d)):h(b,d)},h=function(d,e){d&&i(b,d),a["function"](c.onComposed)&&c.onComposed(d,e)},c.options.composeHilary!==!1?b.Bootstrapper({composeLifecycle:c.hilary.composeLifecycle,composeModules:c.hilary.composeModules,onComposed:function(b,e){a["function"](c.hilary.onComposed)&&c.hilary.onComposed(b,e),d()}}):d()};return b}}),Hilary.scope("gidget").register({name:"Route",factory:function(){"use strict";return function(a,b){var c=this,d=b?"":"i";a=a||{},c.expression=new RegExp("^"+a.expressionString+"/?$",d),c.expressionString=a.expressionString,c.paramNames=a.paramNames,c.source=String(a.source),c.verb=a.verb}}}),Hilary.scope("gidget").register({name:"uriHelper",singleton:!0,dependencies:["is","locale","exceptions"],factory:function(a,b,c){"use strict";var d={parseUri:void 0},e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,f=["source","protocol","authority","userAndPassword","user","password","hostName","port","relativePath","path","directory","file","queryString","hash"],g={name:"query",parser:/(?:^|&)([^&=]*)=?([^&]*)/g};return d.parseUri=function(d){if(a.not.defined(d))c.throwArgumentException(b.errors.parseUriRequiresUriString,"uriString");else{if(a.not.string(d)&&d.path)return d;a.not.string(d)&&c.throwArgumentException(b.errors.parseUriRequiresUriString,"uriString")}var h,i=d,j=d.indexOf("["),k=d.indexOf("]"),l={},m=14;for(-1!==j&&-1!==k&&(d=d.substring(0,j)+d.substring(j,k).replace(/:/g,";")+d.substring(k,d.length)),h=e.exec(d||"");m--;)l[f[m]]=h[m]||void 0;return-1!==j&&-1!==k&&(l.source=i,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.port=l.port&&parseInt(l.port),a.string(l.queryString)&&(l[g.name]={},l.queryString.replace(g.parser,function(a,b,c){b&&(l[g.name][b]=c)})),l.host=l.hostName&&l.port?l.hostName.concat(":",l.port):l.hostName,l.origin=l.authority&&l.protocol.concat("://",l.authority.replace(l.userAndPassword,"").replace("@","")),l},d}}),function(a,b,c){"use strict";var d,e;d=function(c){var f;b.register({name:"application",factory:function(){return{compose:d,start:e}}}),b.register({name:"Blueprint",factory:function(){return a.Blueprint}}),b.register({name:"is",factory:function(){return b.getContext().is}}),b.register({name:"exceptions",dependencies:["ExceptionHandler"],factory:function(a){return f||(f=new a(function(a){throw a.data?console.log(a.message,a.data):console.log(a.message),a})),f}}),b.register({name:"Gidget",blueprint:"IGidget",dependencies:["IRouteEngine","GidgetModule","GidgetRoute","DefaultGidgetBootstrapper","GidgetApp","argumentValidator"],factory:function(a,c,d,e,f,g){var h=function(c){return c=c||{},c.routeEngine=c.routeEngine||b.resolve("DefaultRouteEngine"),g.validate(a,c.routeEngine)?new f(c.routeEngine):void 0};return h.GidgetModule=c,h.GidgetRoute=d,h.Bootstrapper=e,h}}),c()},e=function(){var a=b.resolve("Gidget");c.Gidget=a},d(e)}(Hilary,Hilary.scope("gidget"),"undefined"!=typeof module&&module.exports?module.exports:window);